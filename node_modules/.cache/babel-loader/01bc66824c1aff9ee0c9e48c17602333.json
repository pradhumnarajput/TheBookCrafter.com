{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\pradh\\\\Desktop\\\\devrev\\\\Bookztron-E-Commerce_Book_Store\\\\src\\\\Pages\\\\Shop\\\\Shop.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport jwt_decode from \"jwt-decode\";\nimport { useLocation } from \"react-router-dom\";\nimport \"./Shop.css\";\nimport { Sidebar, ProductCard, useWishlist, useCart, useSearchBar, Pagination } from \"../../index.js\";\nimport { useProductAvailable } from \"../../Context/product-context\";\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction Shop(props) {\n  _s();\n\n  let {\n    productsAvailableList,\n    dispatchSortedProductsList,\n    productFilterOptions\n  } = useProductAvailable();\n  const {\n    dispatchUserWishlist\n  } = useWishlist();\n  const {\n    dispatchUserCart\n  } = useCart();\n  const {\n    pathname\n  } = useLocation();\n  const {\n    searchBarTerm\n  } = useSearchBar();\n  const [currentPage, setCurrentPage] = useState(1);\n  const [productsPerPage, setProductsPerPage] = useState(12);\n  useEffect(() => {\n    window.scrollTo(0, 0);\n  }, [pathname, currentPage]);\n  useEffect(() => {\n    if (JSON.stringify(productsAvailableList) === JSON.stringify([]) && JSON.stringify(productFilterOptions) === JSON.stringify({\n      includeOutOfStock: true,\n      onlyFastDeliveryProducts: false,\n      minPrice: 0,\n      maxPrice: 1200,\n      fiction: true,\n      thriller: true,\n      tech: true,\n      philosophy: true,\n      romance: true,\n      manga: true,\n      minRating: 1\n    })) {\n      //Refresh happened - Filters are default yet productsAvailableList is empty\n      //Redo api call to get data\n      try {\n        (async () => {\n          const productsAvailableData = await axios.get('https://bookztron-server.vercel.app/api/home/products');\n          dispatchSortedProductsList({\n            type: \"ADD_ITEMS_TO_PRODUCTS_AVAILABLE_LIST\",\n            payload: [...productsAvailableData.data.productsList]\n          });\n        })();\n      } catch (error) {\n        console.log(\"Error : \", error);\n      }\n    }\n  }, []);\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n\n    if (token) {\n      const user = jwt_decode(token);\n\n      if (!user) {\n        localStorage.removeItem('token');\n      } else {\n        (async function getUpdatedWishlistAndCart() {\n          let updatedUserInfo = await axios.get(\"https://bookztron-server.vercel.app/api/user\", {\n            headers: {\n              'x-access-token': localStorage.getItem('token')\n            }\n          });\n\n          if (updatedUserInfo.data.status === \"ok\") {\n            dispatchUserWishlist({\n              type: \"UPDATE_USER_WISHLIST\",\n              payload: updatedUserInfo.data.user.wishlist\n            });\n            dispatchUserCart({\n              type: \"UPDATE_USER_CART\",\n              payload: updatedUserInfo.data.user.cart\n            });\n          }\n        })();\n      }\n    }\n  }, []);\n  let searchedProducts = productsAvailableList.filter(productdetails => {\n    return productdetails.bookName.toLowerCase().includes(searchBarTerm.toLowerCase()) || productdetails.author.toLowerCase().includes(searchBarTerm.toLowerCase());\n  });\n  const indexOfLastProduct = currentPage * productsPerPage;\n  const indexOfFirstProduct = indexOfLastProduct - productsPerPage;\n  let currentSearchedProducts = searchedProducts.slice(indexOfFirstProduct, indexOfLastProduct);\n  let currentProductsAvailableList = productsAvailableList.slice(indexOfFirstProduct, indexOfLastProduct);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"shop-container\",\n      children: [/*#__PURE__*/_jsxDEV(Sidebar, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"products-container\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: [\"Showing \", searchBarTerm === \"\" ? productsAvailableList.length : searchedProducts.length, \" products\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"products-card-grid\",\n          children: productsAvailableList && (searchBarTerm === \"\" ? currentProductsAvailableList.map(productdetails => /*#__PURE__*/_jsxDEV(ProductCard, {\n            productdetails: productdetails\n          }, productdetails._id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 127,\n            columnNumber: 35\n          }, this)) : currentSearchedProducts.map(productdetails => /*#__PURE__*/_jsxDEV(ProductCard, {\n            productdetails: productdetails\n          }, productdetails._id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 131,\n            columnNumber: 35\n          }, this)))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Pagination, {\n          productsPerPage: productsPerPage,\n          totalProducts: searchBarTerm === \"\" ? productsAvailableList.length : searchedProducts.length,\n          paginate: setCurrentPage\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 115,\n    columnNumber: 9\n  }, this);\n}\n\n_s(Shop, \"uwiHg7Fi9IxSv6saxohmngemA4U=\", false, function () {\n  return [useProductAvailable, useWishlist, useCart, useLocation, useSearchBar];\n});\n\n_c = Shop;\nexport { Shop };\n\nvar _c;\n\n$RefreshReg$(_c, \"Shop\");","map":{"version":3,"sources":["C:/Users/pradh/Desktop/devrev/Bookztron-E-Commerce_Book_Store/src/Pages/Shop/Shop.jsx"],"names":["React","useState","useEffect","jwt_decode","useLocation","Sidebar","ProductCard","useWishlist","useCart","useSearchBar","Pagination","useProductAvailable","axios","Shop","props","productsAvailableList","dispatchSortedProductsList","productFilterOptions","dispatchUserWishlist","dispatchUserCart","pathname","searchBarTerm","currentPage","setCurrentPage","productsPerPage","setProductsPerPage","window","scrollTo","JSON","stringify","includeOutOfStock","onlyFastDeliveryProducts","minPrice","maxPrice","fiction","thriller","tech","philosophy","romance","manga","minRating","productsAvailableData","get","type","payload","data","productsList","error","console","log","token","localStorage","getItem","user","removeItem","getUpdatedWishlistAndCart","updatedUserInfo","headers","status","wishlist","cart","searchedProducts","filter","productdetails","bookName","toLowerCase","includes","author","indexOfLastProduct","indexOfFirstProduct","currentSearchedProducts","slice","currentProductsAvailableList","length","map","_id"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\r\nimport jwt_decode from \"jwt-decode\"\r\nimport { useLocation } from \"react-router-dom\"\r\nimport \"./Shop.css\"\r\nimport { \r\n  Sidebar, \r\n  ProductCard,\r\n  useWishlist,\r\n  useCart,\r\n  useSearchBar,\r\n  Pagination\r\n} from \"../../index.js\"\r\nimport { useProductAvailable } from \"../../Context/product-context\"\r\nimport axios from 'axios'\r\n\r\nfunction Shop(props) {\r\n\r\n    let { \r\n      productsAvailableList, \r\n      dispatchSortedProductsList, \r\n      productFilterOptions \r\n    } = useProductAvailable()\r\n\r\n    const { dispatchUserWishlist } = useWishlist()\r\n    const { dispatchUserCart } = useCart()\r\n    const { pathname } = useLocation();\r\n    const { searchBarTerm } = useSearchBar()\r\n    const [ currentPage, setCurrentPage ] = useState(1)\r\n    const [ productsPerPage, setProductsPerPage ] = useState(12)\r\n  \r\n    useEffect(() => {\r\n      window.scrollTo(0, 0);\r\n    }, [pathname, currentPage]);\r\n\r\n    useEffect(()=>{\r\n      \r\n      if( (JSON.stringify(productsAvailableList)===JSON.stringify([]))\r\n          && (\r\n              JSON.stringify(productFilterOptions)===JSON.stringify({\r\n              includeOutOfStock        : true,\r\n              onlyFastDeliveryProducts : false,\r\n              minPrice                 : 0,\r\n              maxPrice                 : 1200,\r\n              fiction                  : true,\r\n              thriller                 : true,\r\n              tech                     : true,\r\n              philosophy               : true,\r\n              romance                  : true,\r\n              manga                    : true,\r\n              minRating                : 1}) \r\n             )\r\n        )\r\n      {\r\n        //Refresh happened - Filters are default yet productsAvailableList is empty\r\n        //Redo api call to get data\r\n        try {\r\n          (async () => {\r\n            const productsAvailableData = await axios.get('https://bookztron-server.vercel.app/api/home/products')\r\n            dispatchSortedProductsList({type:\"ADD_ITEMS_TO_PRODUCTS_AVAILABLE_LIST\", payload: [...productsAvailableData.data.productsList] })\r\n          }) ()\r\n        }\r\n        catch(error) {\r\n          console.log(\"Error : \", error);\r\n        }\r\n      }\r\n    },[])\r\n\r\n    useEffect(()=>{\r\n      const token=localStorage.getItem('token')\r\n\r\n      if(token)\r\n      {\r\n        const user = jwt_decode(token)\r\n        if(!user)\r\n        {\r\n            localStorage.removeItem('token')\r\n        }\r\n        else\r\n        {\r\n          (async function getUpdatedWishlistAndCart()\r\n          {\r\n            let updatedUserInfo = await axios.get(\r\n            \"https://bookztron-server.vercel.app/api/user\",\r\n            {\r\n              headers:\r\n              {\r\n                'x-access-token': localStorage.getItem('token'),\r\n              }\r\n            })\r\n\r\n            if(updatedUserInfo.data.status===\"ok\")\r\n            {\r\n              dispatchUserWishlist({type: \"UPDATE_USER_WISHLIST\",payload: updatedUserInfo.data.user.wishlist})\r\n              dispatchUserCart({type: \"UPDATE_USER_CART\",payload: updatedUserInfo.data.user.cart})\r\n            }\r\n          })()\r\n        }\r\n      }   \r\n    },[])\r\n\r\n    let searchedProducts = productsAvailableList\r\n    .filter(productdetails=>{\r\n      return (\r\n        productdetails.bookName.toLowerCase().includes(searchBarTerm.toLowerCase()) \r\n        || productdetails.author.toLowerCase().includes(searchBarTerm.toLowerCase())\r\n      )\r\n    })\r\n\r\n    const indexOfLastProduct = currentPage * productsPerPage;\r\n    const indexOfFirstProduct= indexOfLastProduct - productsPerPage;\r\n    let currentSearchedProducts = searchedProducts.slice(indexOfFirstProduct, indexOfLastProduct)\r\n    let currentProductsAvailableList = productsAvailableList.slice(indexOfFirstProduct, indexOfLastProduct)\r\n\r\n    return (\r\n        <div>\r\n            <div className='shop-container'>\r\n                <Sidebar/>\r\n                <div className='products-container'>\r\n                    <h2>Showing {searchBarTerm === \"\"?productsAvailableList.length:searchedProducts.length} products</h2>\r\n                    <div className=\"products-card-grid\">\r\n                        {\r\n                            productsAvailableList && \r\n                            (\r\n                              searchBarTerm === \"\" ?\r\n                              (\r\n                                currentProductsAvailableList.map(productdetails => (\r\n                                  <ProductCard key={productdetails._id} productdetails={productdetails} />\r\n                                ))\r\n                              ) : (\r\n                                currentSearchedProducts.map(productdetails => (\r\n                                  <ProductCard key={productdetails._id} productdetails={productdetails} />\r\n                                ))\r\n                              )\r\n                            )\r\n                        }\r\n                    </div>\r\n                    <Pagination \r\n                      productsPerPage={productsPerPage} \r\n                      totalProducts={searchBarTerm === \"\"?productsAvailableList.length:searchedProducts.length}\r\n                      paginate={setCurrentPage}\r\n                    />\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport { Shop }"]},"metadata":{},"sourceType":"module"}