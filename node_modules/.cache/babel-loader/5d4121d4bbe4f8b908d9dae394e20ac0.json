{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\pradh\\\\Desktop\\\\devrev\\\\TheBookCrafter.com\\\\src\\\\Components\\\\WishlistProductCard\\\\WishlistProductCard.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { Link, useNavigate } from \"react-router-dom\";\nimport axios from \"axios\";\nimport jwt_decode from \"jwt-decode\";\nimport './WishlistProductCard.css';\nimport { useToast, useWishlist, useCart } from '../../index';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function WishlistProductCard(_ref) {\n  _s();\n\n  let {\n    productdetails\n  } = _ref;\n  const navigate = useNavigate();\n  const {\n    userWishlist,\n    dispatchUserWishlist\n  } = useWishlist();\n  const {\n    dispatchUserCart\n  } = useCart();\n  const {\n    showToast\n  } = useToast();\n  const {\n    _id,\n    bookName,\n    author,\n    originalPrice,\n    discountedPrice,\n    discountPercent,\n    imgSrc,\n    imgAlt,\n    badgeText,\n    outOfStock\n  } = productdetails;\n  const [wishlistHeartIcon, setWishlistHeartIcon] = useState(\"fa-heart-o\");\n  const [wishlistBtn, setWishlistBtn] = useState(\"add-to-wishlist-btn\");\n  useEffect(() => {\n    const index = userWishlist.findIndex(product => {\n      return product._id === productdetails._id;\n    });\n\n    if (index !== -1) {\n      setWishlistHeartIcon(\"fa-heart\");\n      setWishlistBtn(\"added-to-wishlist-btn\");\n    } else {\n      setWishlistHeartIcon(\"fa-heart-o\");\n      setWishlistBtn(\"add-to-wishlist-btn\");\n    }\n  }, [userWishlist, productdetails._id, setWishlistHeartIcon, setWishlistBtn]);\n\n  async function addOrRemoveItemToWishlist() {\n    if (wishlistHeartIcon === \"fa-heart-o\" && wishlistBtn === \"add-to-wishlist-btn\") {\n      //Item not present in wishlist, add it\n      const token = localStorage.getItem('token');\n\n      if (token) {\n        const user = jwt_decode(token);\n\n        if (!user) {\n          localStorage.removeItem('token');\n          showToast(\"warning\", \"\", \"Kindly Login\");\n          navigate('/login');\n        } else {\n          let wishlistUpdateResponse = await axios.patch(\"https://bookztron-server.vercel.app/api/wishlist\", {\n            productdetails\n          }, {\n            headers: {\n              'x-access-token': localStorage.getItem('token')\n            }\n          });\n\n          if (wishlistUpdateResponse.data.status === \"ok\") {\n            setWishlistHeartIcon(\"fa-heart\");\n            setWishlistBtn(\"added-to-wishlist-btn\");\n            dispatchUserWishlist({\n              type: \"UPDATE_USER_WISHLIST\",\n              payload: wishlistUpdateResponse.data.user.wishlist\n            });\n            showToast(\"success\", \"\", \"Item successfully added to wishlist\");\n          }\n        }\n      } else {\n        showToast(\"warning\", \"\", \"Kindly Login\");\n      }\n    } else {\n      //Item present in wishlist, remove it\n      const token = localStorage.getItem('token');\n\n      if (token) {\n        const user = jwt_decode(token);\n\n        if (!user) {\n          localStorage.removeItem('token');\n          showToast(\"warning\", \"\", \"Kindly Login\");\n          navigate('/login');\n        } else {\n          let wishlistUpdateResponse = await axios.delete(`https://bookztron-server.vercel.app/api/wishlist/${productdetails._id}`, {\n            headers: {\n              'x-access-token': localStorage.getItem('token')\n            }\n          }, {\n            productdetails\n          });\n\n          if (wishlistUpdateResponse.data.status === \"ok\") {\n            setWishlistHeartIcon(\"fa-heart-o\");\n            setWishlistBtn(\"add-to-wishlist-btn\");\n            dispatchUserWishlist({\n              type: \"UPDATE_USER_WISHLIST\",\n              payload: wishlistUpdateResponse.data.user.wishlist\n            });\n            showToast(\"success\", \"\", \"Item successfully deleted from wishlist\");\n          }\n        }\n      } else {\n        showToast(\"warning\", \"\", \"Kindly Login\");\n      }\n    }\n  }\n\n  async function addItemToCart() {\n    const token = localStorage.getItem('token');\n\n    if (token) {\n      const user = jwt_decode(token);\n\n      if (!user) {\n        localStorage.removeItem('token');\n        showToast(\"warning\", \"\", \"Kindly Login\");\n        navigate('/login');\n      } else {\n        let cartUpdateResponse = await axios.patch(\"https://bookztron-server.vercel.app/api/cart\", {\n          productdetails\n        }, {\n          headers: {\n            'x-access-token': localStorage.getItem('token')\n          }\n        });\n\n        if (cartUpdateResponse.data.status === \"ok\") {\n          dispatchUserCart({\n            type: \"UPDATE_USER_CART\",\n            payload: cartUpdateResponse.data.user.cart\n          });\n          showToast(\"success\", \"\", \"Item successfully added to cart\");\n        }\n      }\n    } else {\n      showToast(\"warning\", \"\", \"Kindly Login\");\n    }\n  }\n\n  return /*#__PURE__*/_jsxDEV(Link, {\n    to: `/shop/${_id}`,\n    onClick: () => localStorage.setItem(`${_id}`, JSON.stringify(productdetails)),\n    target: \"_blank\",\n    rel: \"noopener noreferrer\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card-basic wishlist-card\",\n      children: [/*#__PURE__*/_jsxDEV(\"img\", {\n        src: imgSrc,\n        alt: imgAlt\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"card-item-details\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"item-title\",\n          children: /*#__PURE__*/_jsxDEV(\"h4\", {\n            children: bookName\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 194,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 193,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"h5\", {\n          className: \"item-author\",\n          children: [\"- By  \\xA0\", author]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 196,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [/*#__PURE__*/_jsxDEV(\"b\", {\n            children: [\"Rs. \", discountedPrice, \"   \\xA0\\xA0\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 197,\n            columnNumber: 24\n          }, this), /*#__PURE__*/_jsxDEV(\"del\", {\n            children: [\"Rs. \", originalPrice]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 197,\n            columnNumber: 67\n          }, this), \" \\xA0\\xA0\", /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"discount-on-card\",\n            children: [\"(\", discountPercent, \"% off)\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 198,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 197,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"card-button\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: event => {\n              event.preventDefault();\n              event.stopPropagation();\n              addOrRemoveItemToWishlist();\n            },\n            className: `card-icon-btn ${wishlistBtn} outline-card-secondary-btn`,\n            children: /*#__PURE__*/_jsxDEV(\"i\", {\n              className: `fa fa-x ${wishlistHeartIcon}`,\n              \"aria-hidden\": \"true\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 208,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 201,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 200,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"badge-on-card\",\n          children: badgeText\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 211,\n          columnNumber: 21\n        }, this), outOfStock && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"card-text-overlay-container\",\n          children: /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Out of Stock\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 217,\n            columnNumber: 37\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 216,\n          columnNumber: 29\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"solid-primary-btn add-wishlist-item-to-cart-btn\",\n        onClick: event => {\n          event.preventDefault();\n          event.stopPropagation();\n          addItemToCart(event);\n        },\n        children: \"Add to Cart\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 184,\n    columnNumber: 9\n  }, this);\n}\n\n_s(WishlistProductCard, \"8wy7VCRVqrNlQlS0oExba8kba8o=\", false, function () {\n  return [useNavigate, useWishlist, useCart, useToast];\n});\n\n_c = WishlistProductCard;\nexport { WishlistProductCard };\n\nvar _c;\n\n$RefreshReg$(_c, \"WishlistProductCard\");","map":{"version":3,"sources":["C:/Users/pradh/Desktop/devrev/TheBookCrafter.com/src/Components/WishlistProductCard/WishlistProductCard.jsx"],"names":["React","useEffect","useState","Link","useNavigate","axios","jwt_decode","useToast","useWishlist","useCart","WishlistProductCard","productdetails","navigate","userWishlist","dispatchUserWishlist","dispatchUserCart","showToast","_id","bookName","author","originalPrice","discountedPrice","discountPercent","imgSrc","imgAlt","badgeText","outOfStock","wishlistHeartIcon","setWishlistHeartIcon","wishlistBtn","setWishlistBtn","index","findIndex","product","addOrRemoveItemToWishlist","token","localStorage","getItem","user","removeItem","wishlistUpdateResponse","patch","headers","data","status","type","payload","wishlist","delete","addItemToCart","cartUpdateResponse","cart","setItem","JSON","stringify","event","preventDefault","stopPropagation"],"mappings":"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","sourcesContent":["import React,{ useEffect, useState} from 'react'\r\nimport { Link, useNavigate } from \"react-router-dom\"\r\nimport axios from \"axios\"\r\nimport jwt_decode from \"jwt-decode\";\r\nimport './WishlistProductCard.css'\r\nimport {\r\n    useToast,\r\n    useWishlist,\r\n    useCart\r\n} from '../../index'\r\n\r\nexport default function WishlistProductCard({ productdetails }) \r\n{\r\n    const navigate = useNavigate()\r\n\r\n    const { userWishlist, dispatchUserWishlist } = useWishlist()\r\n    const { dispatchUserCart } = useCart()\r\n    const { showToast } = useToast()\r\n    const {\r\n        _id, \r\n        bookName,\r\n        author,\r\n        originalPrice,\r\n        discountedPrice,\r\n        discountPercent,\r\n        imgSrc, \r\n        imgAlt,\r\n        badgeText, \r\n        outOfStock\r\n    } = productdetails\r\n    const [wishlistHeartIcon, setWishlistHeartIcon] = useState(\"fa-heart-o\")\r\n    const [wishlistBtn, setWishlistBtn]             = useState(\"add-to-wishlist-btn\")\r\n\r\n    useEffect(()=>{\r\n        const index = userWishlist.findIndex(product=> {\r\n            return product._id === productdetails._id\r\n        })\r\n\r\n        if(index!==-1)\r\n        {\r\n            setWishlistHeartIcon(\"fa-heart\")\r\n            setWishlistBtn(\"added-to-wishlist-btn\")\r\n        }\r\n        else\r\n        {\r\n            setWishlistHeartIcon(\"fa-heart-o\")\r\n            setWishlistBtn(\"add-to-wishlist-btn\")\r\n        }\r\n    },[userWishlist, productdetails._id, setWishlistHeartIcon, setWishlistBtn])\r\n\r\n    async function addOrRemoveItemToWishlist()\r\n    {\r\n        if(wishlistHeartIcon===\"fa-heart-o\" && wishlistBtn ===\"add-to-wishlist-btn\")\r\n        {\r\n            //Item not present in wishlist, add it\r\n            const token=localStorage.getItem('token')\r\n\r\n            if(token)\r\n            {\r\n                const user = jwt_decode(token)\r\n                \r\n                if(!user)\r\n                {\r\n                    localStorage.removeItem('token')\r\n                    showToast(\"warning\",\"\",\"Kindly Login\")\r\n                    navigate('/login')\r\n                }\r\n                else\r\n                {\r\n                    let wishlistUpdateResponse = await axios.patch(\r\n                        \"https://bookztron-server.vercel.app/api/wishlist\",\r\n                        {\r\n                            productdetails\r\n                        },\r\n                        {\r\n                            headers:\r\n                            {\r\n                                'x-access-token': localStorage.getItem('token'),\r\n                            }\r\n                        }\r\n                    )\r\n            \r\n                    if(wishlistUpdateResponse.data.status===\"ok\")\r\n                    {\r\n                        setWishlistHeartIcon(\"fa-heart\")\r\n                        setWishlistBtn(\"added-to-wishlist-btn\")\r\n                        dispatchUserWishlist({type: \"UPDATE_USER_WISHLIST\",payload: wishlistUpdateResponse.data.user.wishlist})\r\n                        showToast(\"success\",\"\",\"Item successfully added to wishlist\")\r\n                    }\r\n                }\r\n            }\r\n            else\r\n            {\r\n                showToast(\"warning\",\"\",\"Kindly Login\")\r\n            }   \r\n        }\r\n        else\r\n        {\r\n            //Item present in wishlist, remove it\r\n            const token=localStorage.getItem('token')\r\n\r\n            if(token)\r\n            {\r\n                const user = jwt_decode(token)\r\n                \r\n                if(!user)\r\n                {\r\n                    localStorage.removeItem('token')\r\n                    showToast(\"warning\",\"\",\"Kindly Login\")\r\n                    navigate('/login')\r\n                }\r\n                else\r\n                {\r\n                    let wishlistUpdateResponse = await axios.delete(\r\n                        `https://bookztron-server.vercel.app/api/wishlist/${productdetails._id}`,\r\n                        {\r\n                            headers:\r\n                            {\r\n                                'x-access-token': localStorage.getItem('token'),\r\n                            }\r\n                        },\r\n                        {\r\n                            productdetails\r\n                        }\r\n                    )\r\n                    if(wishlistUpdateResponse.data.status===\"ok\")\r\n                    {\r\n                        setWishlistHeartIcon(\"fa-heart-o\")\r\n                        setWishlistBtn(\"add-to-wishlist-btn\")\r\n                        dispatchUserWishlist({type: \"UPDATE_USER_WISHLIST\",payload: wishlistUpdateResponse.data.user.wishlist})\r\n                        showToast(\"success\",\"\",\"Item successfully deleted from wishlist\")\r\n                    }\r\n                }\r\n            }\r\n            else\r\n            {\r\n                showToast(\"warning\",\"\",\"Kindly Login\")\r\n            }   \r\n        }    \r\n    }\r\n\r\n    async function addItemToCart()\r\n    {\r\n        const token=localStorage.getItem('token')\r\n\r\n        if(token)\r\n        {\r\n            const user = jwt_decode(token)\r\n            \r\n            if(!user)\r\n            {\r\n                localStorage.removeItem('token')\r\n                showToast(\"warning\",\"\",\"Kindly Login\")\r\n                navigate('/login')\r\n            }\r\n            else\r\n            {\r\n                let cartUpdateResponse = await axios.patch(\r\n                    \"https://bookztron-server.vercel.app/api/cart\",\r\n                    {\r\n                        productdetails\r\n                    },\r\n                    {\r\n                        headers:\r\n                        {\r\n                            'x-access-token': localStorage.getItem('token'),\r\n                        }\r\n                    }\r\n                )\r\n                if(cartUpdateResponse.data.status===\"ok\")\r\n                {\r\n                    dispatchUserCart({type: \"UPDATE_USER_CART\",payload: cartUpdateResponse.data.user.cart})\r\n                    showToast(\"success\",\"\",\"Item successfully added to cart\")\r\n                }\r\n            }\r\n        }\r\n        else\r\n        {\r\n            showToast(\"warning\",\"\",\"Kindly Login\")\r\n        } \r\n    }\r\n    \r\n    return (\r\n        <Link \r\n            to={`/shop/${_id}`}  \r\n            onClick={() => localStorage.setItem(`${_id}`, JSON.stringify(productdetails))}\r\n            target=\"_blank\"\r\n            rel=\"noopener noreferrer\"\r\n        >\r\n            <div className=\"card-basic wishlist-card\">\r\n                <img src={imgSrc} alt={imgAlt}/>\r\n                <div className=\"card-item-details\">\r\n                    <div className=\"item-title\">\r\n                        <h4>{bookName}</h4>\r\n                    </div>\r\n                    <h5 className=\"item-author\">- By  &nbsp;{author}</h5>\r\n                    <p><b>Rs. {discountedPrice}   &nbsp;&nbsp;</b><del>Rs. {originalPrice}</del> &nbsp;&nbsp;\r\n                        <span className=\"discount-on-card\">({discountPercent}% off)</span>\r\n                    </p>\r\n                    <div className=\"card-button\">\r\n                        <button \r\n                            onClick={(event)=>{\r\n                                event.preventDefault();\r\n                                event.stopPropagation();\r\n                                addOrRemoveItemToWishlist()\r\n                            }} \r\n                            className={`card-icon-btn ${wishlistBtn} outline-card-secondary-btn`}>\r\n                                <i className={`fa fa-x ${wishlistHeartIcon}`} aria-hidden=\"true\"></i>\r\n                        </button>\r\n                    </div>\r\n                    <div className=\"badge-on-card\">\r\n                        {badgeText}\r\n                    </div>\r\n                    {\r\n                        outOfStock && (\r\n                            <div className=\"card-text-overlay-container\">\r\n                                    <p>Out of Stock</p>\r\n                            </div>\r\n                        )\r\n                    }\r\n                </div>\r\n                <button \r\n                        className=\"solid-primary-btn add-wishlist-item-to-cart-btn\"\r\n                        onClick={event=>{\r\n                            event.preventDefault()\r\n                            event.stopPropagation()\r\n                            addItemToCart(event)\r\n                        }}\r\n                >\r\n                        Add to Cart\r\n                </button>\r\n            </div>\r\n        </Link>\r\n    )\r\n}\r\n\r\nexport { WishlistProductCard };"]},"metadata":{},"sourceType":"module"}