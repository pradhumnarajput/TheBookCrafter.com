{"ast":null,"code":"import _asyncToGenerator from\"C:/Users/pradh/Desktop/devrev/TheBookCrafter.com/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/pradh/Desktop/devrev/TheBookCrafter.com/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\pradh\\\\Desktop\\\\devrev\\\\TheBookCrafter.com\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React,{useState,useEffect}from\"react\";import jwt_decode from\"jwt-decode\";import\"./UserAuth.css\";import{Link,useNavigate}from\"react-router-dom\";import axios from\"axios\";import{useToast,useUserLogin,useWishlist,useCart,useOrders}from\"../../index\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Login(){var _useUserLogin=useUserLogin(),setUserLoggedIn=_useUserLogin.setUserLoggedIn;var _useToast=useToast(),showToast=_useToast.showToast;var _useWishlist=useWishlist(),dispatchUserWishlist=_useWishlist.dispatchUserWishlist;var _useCart=useCart(),dispatchUserCart=_useCart.dispatchUserCart;var _useOrders=useOrders(),dispatchUserOrders=_useOrders.dispatchUserOrders;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),userEmail=_useState2[0],setUserEmail=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),userPassword=_useState4[0],setUserPassword=_useState4[1];useEffect(function(){var token=localStorage.getItem('token');if(token){var user=jwt_decode(token);if(!user){localStorage.removeItem('token');}else{(function(){var _getUpdatedWishlistAndCart=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var updatedUserInfo;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get(\"https://bookztron-server.vercel.app/api/user\",{headers:{'x-access-token':localStorage.getItem('token')}});case 2:updatedUserInfo=_context.sent;if(updatedUserInfo.data.status===\"ok\"){dispatchUserWishlist({type:\"UPDATE_USER_WISHLIST\",payload:updatedUserInfo.data.user.wishlist});dispatchUserCart({type:\"UPDATE_USER_CART\",payload:updatedUserInfo.data.user.cart});dispatchUserOrders({type:\"UPDATE_USER_ORDERS\",payload:updatedUserInfo.data.user.orders});}case 4:case\"end\":return _context.stop();}}},_callee);}));function getUpdatedWishlistAndCart(){return _getUpdatedWishlistAndCart.apply(this,arguments);}return getUpdatedWishlistAndCart;})()();}}},[]);var navigate=useNavigate();function loginUser(event){event.preventDefault();axios.post(\"https://bookztron-server.vercel.app/api/login\",{userEmail:userEmail,userPassword:userPassword}).then(function(res){if(res.data.user){localStorage.setItem('token',res.data.user);showToast(\"success\",\"\",\"Logged in successfully\");setUserLoggedIn(true);dispatchUserWishlist({type:\"UPDATE_USER_WISHLIST\",payload:res.data.wishlist});dispatchUserCart({type:\"UPDATE_USER_CART\",payload:res.data.cart});dispatchUserOrders({type:\"UPDATE_USER_ORDERS\",payload:res.data.orders});navigate('/shop');}else{throw new Error(\"Error in user login\");}}).catch(function(err){showToast(\"error\",\"\",\"Error logging in user. Please try again\");});}return/*#__PURE__*/_jsx(\"div\",{className:\"user-auth-content-container\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:loginUser,className:\"user-auth-form\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Login\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"user-auth-input-container\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"user-auth-input-email\",children:/*#__PURE__*/_jsx(\"h4\",{children:\"Email address\"})}),/*#__PURE__*/_jsx(\"input\",{id:\"user-auth-input-email\",className:\"user-auth-form-input\",type:\"email\",placeholder:\"Email\",value:userEmail,onChange:function onChange(event){return setUserEmail(event.target.value);},required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"user-auth-input-container\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"user-auth-input-password\",children:/*#__PURE__*/_jsx(\"h4\",{children:\"Password\"})}),/*#__PURE__*/_jsx(\"input\",{id:\"user-auth-input-password\",className:\"user-auth-form-input\",type:\"password\",placeholder:\"Password\",value:userPassword,onChange:function onChange(event){return setUserPassword(event.target.value);},required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"user-options-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"remember-me-container\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",id:\"remember-me\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"remember-me\",children:\"Remember Me\"})]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Link,{to:\"#\",className:\"links-with-blue-underline\",id:\"forgot-password\",children:\"Forgot Password?\"})})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"solid-success-btn form-user-auth-submit-btn\",children:\"Login\"}),/*#__PURE__*/_jsx(\"div\",{className:\"new-user-container\",children:/*#__PURE__*/_jsx(Link,{to:\"/signup\",className:\"links-with-blue-underline\",id:\"new-user-link\",children:\"Create new account \\xA0\"})})]})});}export{Login};","map":{"version":3,"sources":["C:/Users/pradh/Desktop/devrev/TheBookCrafter.com/src/Pages/AuthenticationPages/Login.jsx"],"names":["React","useState","useEffect","jwt_decode","Link","useNavigate","axios","useToast","useUserLogin","useWishlist","useCart","useOrders","Login","setUserLoggedIn","showToast","dispatchUserWishlist","dispatchUserCart","dispatchUserOrders","userEmail","setUserEmail","userPassword","setUserPassword","token","localStorage","getItem","user","removeItem","get","headers","updatedUserInfo","data","status","type","payload","wishlist","cart","orders","getUpdatedWishlistAndCart","navigate","loginUser","event","preventDefault","post","then","res","setItem","Error","catch","err","target","value"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\"\r\nimport jwt_decode from \"jwt-decode\"\r\nimport \"./UserAuth.css\"\r\nimport { Link, useNavigate } from \"react-router-dom\"\r\nimport axios from \"axios\"\r\nimport { \r\n    useToast, \r\n    useUserLogin, \r\n    useWishlist,\r\n    useCart,\r\n    useOrders\r\n} from \"../../index\"\r\n\r\nfunction Login()\r\n{\r\n    const { setUserLoggedIn }       = useUserLogin()\r\n    const { showToast }             = useToast()\r\n    const { dispatchUserWishlist }  = useWishlist()\r\n    const { dispatchUserCart }      = useCart()\r\n    const { dispatchUserOrders }    = useOrders()\r\n\r\n    const [userEmail    , setUserEmail]    = useState('')\r\n    const [userPassword , setUserPassword] = useState('')\r\n\r\n    useEffect(()=>{\r\n        const token=localStorage.getItem('token')\r\n\r\n        if(token)\r\n        {\r\n            const user = jwt_decode(token)\r\n            if(!user)\r\n            {\r\n                localStorage.removeItem('token')\r\n            }\r\n            else\r\n            {\r\n                (async function getUpdatedWishlistAndCart()\r\n                {\r\n                    let updatedUserInfo = await axios.get(\r\n                    \"https://bookztron-server.vercel.app/api/user\",\r\n                    {\r\n                        headers:\r\n                        {\r\n                        'x-access-token': localStorage.getItem('token'),\r\n                        }\r\n                    })\r\n\r\n                    if(updatedUserInfo.data.status===\"ok\")\r\n                    {\r\n                        dispatchUserWishlist({type: \"UPDATE_USER_WISHLIST\",payload: updatedUserInfo.data.user.wishlist})\r\n                        dispatchUserCart({type: \"UPDATE_USER_CART\",payload: updatedUserInfo.data.user.cart})\r\n                        dispatchUserOrders({type: \"UPDATE_USER_ORDERS\",payload: updatedUserInfo.data.user.orders})\r\n                    }\r\n                })()\r\n            }\r\n        }   \r\n    },[])\r\n\r\n    const navigate = useNavigate()\r\n\r\n    function loginUser(event)\r\n    {\r\n        event.preventDefault();\r\n        axios.post(\r\n            \"https://bookztron-server.vercel.app/api/login\",\r\n            {\r\n                userEmail,\r\n                userPassword\r\n            }\r\n        )\r\n        .then(res => {\r\n            \r\n            if(res.data.user)\r\n            {\r\n                localStorage.setItem('token',res.data.user)\r\n                showToast(\"success\",\"\",\"Logged in successfully\")\r\n                setUserLoggedIn(true)\r\n                dispatchUserWishlist({type: \"UPDATE_USER_WISHLIST\",payload: res.data.wishlist})\r\n                dispatchUserCart({type: \"UPDATE_USER_CART\",payload: res.data.cart})\r\n                dispatchUserOrders({type: \"UPDATE_USER_ORDERS\",payload: res.data.orders})\r\n                navigate('/shop')\r\n            }\r\n            else\r\n            {\r\n                throw new Error(\"Error in user login\")\r\n            }\r\n\r\n        })\r\n        .catch(err=>{\r\n            showToast(\"error\",\"\",\"Error logging in user. Please try again\")\r\n        })\r\n    }\r\n\r\n    return (\r\n        <div className=\"user-auth-content-container\">\r\n            <form onSubmit={loginUser} className=\"user-auth-form\">\r\n                <h2>Login</h2>\r\n                \r\n                <div className=\"user-auth-input-container\">\r\n                    <label htmlFor=\"user-auth-input-email\"><h4>Email address</h4></label>\r\n                    <input \r\n                        id=\"user-auth-input-email\" \r\n                        className=\"user-auth-form-input\" \r\n                        type=\"email\" \r\n                        placeholder=\"Email\" \r\n                        value={userEmail}\r\n                        onChange={(event)=>setUserEmail(event.target.value)}\r\n                        required/>\r\n                </div>\r\n\r\n                <div className=\"user-auth-input-container\">\r\n                    <label htmlFor=\"user-auth-input-password\"><h4>Password</h4></label>\r\n                    <input \r\n                        id=\"user-auth-input-password\" \r\n                        className=\"user-auth-form-input\" \r\n                        type=\"password\" \r\n                        placeholder=\"Password\" \r\n                        value={userPassword}\r\n                        onChange={(event)=>setUserPassword(event.target.value)}\r\n                        required/>\r\n                </div>\r\n\r\n                <div className=\"user-options-container\">\r\n                    <div className=\"remember-me-container\">\r\n                        <input type=\"checkbox\" id=\"remember-me\"/>\r\n                        <label htmlFor=\"remember-me\">Remember Me</label>\r\n                    </div>\r\n                    <div>\r\n                        <Link to=\"#\" className=\"links-with-blue-underline\" id=\"forgot-password\">\r\n                            Forgot Password?\r\n                        </Link>\r\n                    </div>\r\n                </div>\r\n\r\n                <button type=\"submit\" className=\"solid-success-btn form-user-auth-submit-btn\">Login</button>\r\n\r\n                <div className=\"new-user-container\">\r\n                    <Link to=\"/signup\" className=\"links-with-blue-underline\" id=\"new-user-link\">\r\n                        Create new account &nbsp; \r\n                    </Link>\r\n                </div>\r\n\r\n            </form>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport { Login }"]},"metadata":{},"sourceType":"module"}